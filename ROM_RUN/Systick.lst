   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 2
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"Systick.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.align	1
  18              		.p2align 2,,3
  19              		.global	SysTickHandler
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	SysTickHandler:
  25              	.LFB0:
  26              		.file 1 "hal/system/Systick.c"
   1:hal/system/Systick.c **** /*
   2:hal/system/Systick.c ****  * SysTick.c
   3:hal/system/Systick.c ****  *
   4:hal/system/Systick.c ****  *  Created on: 01.04.2019
   5:hal/system/Systick.c ****  *      Author: OK / ED
   6:hal/system/Systick.c ****  */
   7:hal/system/Systick.c **** 
   8:hal/system/Systick.c **** #include "SysTick.h"
   9:hal/system/Systick.c **** 
  10:hal/system/Systick.c **** static volatile uint32_t sysTickTimer = 0;
  11:hal/system/Systick.c **** static volatile uint8_t sysTickDivFlag = 0;
  12:hal/system/Systick.c **** 
  13:hal/system/Systick.c **** #ifdef USE_UART_INTERFACE
  14:hal/system/Systick.c **** 	#include "../comm/UART.h"
  15:hal/system/Systick.c **** 	extern volatile uint8_t UARTTimeoutFlag;
  16:hal/system/Systick.c **** 	extern volatile uint32_t UARTTimeoutTimer;
  17:hal/system/Systick.c **** #endif
  18:hal/system/Systick.c **** 
  19:hal/system/Systick.c **** /* handler for SysTick interrupt */
  20:hal/system/Systick.c **** void SysTickHandler(void)
  21:hal/system/Systick.c **** {
  27              		.loc 1 21 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
  22:hal/system/Systick.c **** 	if(sysTickDivFlag)
  32              		.loc 1 22 2 view .LVU1
  33              		.loc 1 22 5 is_stmt 0 view .LVU2
  34 0000 0B4B     		ldr	r3, .L8
  35 0002 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  36              		.loc 1 22 4 view .LVU3
  37 0004 82B1     		cbz	r2, .L2
  23:hal/system/Systick.c **** 	{
  24:hal/system/Systick.c **** 		// increment 1ms timer for systick_getTimer()
  25:hal/system/Systick.c **** 		sysTickTimer++;
  38              		.loc 1 25 3 is_stmt 1 view .LVU4
  39              		.loc 1 25 15 is_stmt 0 view .LVU5
  40 0006 5A68     		ldr	r2, [r3, #4]
  26:hal/system/Systick.c **** 
  27:hal/system/Systick.c **** #ifdef USE_UART_INTERFACE
  28:hal/system/Systick.c **** 
  29:hal/system/Systick.c **** 		// decrease UART receive timeout
  30:hal/system/Systick.c **** 		if(UARTTimeoutTimer > 0)
  41              		.loc 1 30 23 view .LVU6
  42 0008 0A49     		ldr	r1, .L8+4
  25:hal/system/Systick.c **** 
  43              		.loc 1 25 15 view .LVU7
  44 000a 0132     		adds	r2, r2, #1
  45 000c 5A60     		str	r2, [r3, #4]
  46              		.loc 1 30 3 is_stmt 1 view .LVU8
  47              		.loc 1 30 23 is_stmt 0 view .LVU9
  48 000e 0A68     		ldr	r2, [r1]
  49              		.loc 1 30 5 view .LVU10
  50 0010 3AB1     		cbz	r2, .L4
  31:hal/system/Systick.c **** 		{
  32:hal/system/Systick.c **** 			UARTTimeoutTimer--;
  51              		.loc 1 32 4 is_stmt 1 view .LVU11
  52              		.loc 1 32 20 is_stmt 0 view .LVU12
  53 0012 0A68     		ldr	r2, [r1]
  54 0014 013A     		subs	r2, r2, #1
  55 0016 0A60     		str	r2, [r1]
  33:hal/system/Systick.c **** 			if(UARTTimeoutTimer == 0)
  56              		.loc 1 33 4 is_stmt 1 view .LVU13
  57              		.loc 1 33 24 is_stmt 0 view .LVU14
  58 0018 0A68     		ldr	r2, [r1]
  59              		.loc 1 33 6 view .LVU15
  60 001a 12B9     		cbnz	r2, .L4
  34:hal/system/Systick.c **** 				UARTTimeoutFlag = true;
  61              		.loc 1 34 5 is_stmt 1 view .LVU16
  62              		.loc 1 34 21 is_stmt 0 view .LVU17
  63 001c 0121     		movs	r1, #1
  64 001e 064A     		ldr	r2, .L8+8
  65 0020 1170     		strb	r1, [r2]
  66              	.L4:
  35:hal/system/Systick.c **** 		}
  36:hal/system/Systick.c **** #endif
  37:hal/system/Systick.c **** 
  38:hal/system/Systick.c **** 		sysTickDivFlag = 0;
  67              		.loc 1 38 3 is_stmt 1 view .LVU18
  68              		.loc 1 38 18 is_stmt 0 view .LVU19
  69 0022 0022     		movs	r2, #0
  70 0024 1A70     		strb	r2, [r3]
  71 0026 7047     		bx	lr
  72              	.L2:
  39:hal/system/Systick.c **** 	}
  40:hal/system/Systick.c **** 	else
  41:hal/system/Systick.c **** 	{
  42:hal/system/Systick.c **** 		sysTickDivFlag = 1;
  73              		.loc 1 42 3 is_stmt 1 view .LVU20
  74              		.loc 1 42 18 is_stmt 0 view .LVU21
  75 0028 0122     		movs	r2, #1
  76 002a 1A70     		strb	r2, [r3]
  43:hal/system/Systick.c **** 	}
  44:hal/system/Systick.c **** }
  77              		.loc 1 44 1 view .LVU22
  78 002c 7047     		bx	lr
  79              	.L9:
  80 002e 00BF     		.align	2
  81              	.L8:
  82 0030 00000000 		.word	.LANCHOR0
  83 0034 00000000 		.word	UARTTimeoutTimer
  84 0038 00000000 		.word	UARTTimeoutFlag
  85              		.cfi_endproc
  86              	.LFE0:
  88              		.align	1
  89              		.p2align 2,,3
  90              		.global	systick_init
  91              		.syntax unified
  92              		.thumb
  93              		.thumb_func
  95              	systick_init:
  96              	.LFB1:
  45:hal/system/Systick.c **** 
  46:hal/system/Systick.c **** /* initialize SysTick timer */
  47:hal/system/Systick.c **** void systick_init()
  48:hal/system/Systick.c **** {
  97              		.loc 1 48 1 is_stmt 1 view -0
  98              		.cfi_startproc
  99              		@ args = 0, pretend = 0, frame = 0
 100              		@ frame_needed = 0, uses_anonymous_args = 0
  49:hal/system/Systick.c **** 	/* Select AHB clock(HCLK) as SysTick clock source */
  50:hal/system/Systick.c **** 	SysTick_CLKSourceConfig(SysTick_CLKSource_HCLK);
 101              		.loc 1 50 2 view .LVU24
  48:hal/system/Systick.c **** 	/* Select AHB clock(HCLK) as SysTick clock source */
 102              		.loc 1 48 1 is_stmt 0 view .LVU25
 103 003c 08B5     		push	{r3, lr}
 104              	.LCFI0:
 105              		.cfi_def_cfa_offset 8
 106              		.cfi_offset 3, -8
 107              		.cfi_offset 14, -4
 108              		.loc 1 50 2 view .LVU26
 109 003e 0420     		movs	r0, #4
 110 0040 FFF7FEFF 		bl	SysTick_CLKSourceConfig
 111              	.LVL0:
  51:hal/system/Systick.c **** 	/* SysTick interrupt each 500usec with Core clock equal to 72MHz */
  52:hal/system/Systick.c **** 	SysTick_SetReload(36000);
 112              		.loc 1 52 2 is_stmt 1 view .LVU27
 113 0044 48F6A040 		movw	r0, #36000
 114 0048 FFF7FEFF 		bl	SysTick_SetReload
 115              	.LVL1:
  53:hal/system/Systick.c **** 	/* Enable SysTick Counter */
  54:hal/system/Systick.c **** 	SysTick_CounterCmd(SysTick_Counter_Enable);
 116              		.loc 1 54 2 view .LVU28
 117 004c 0120     		movs	r0, #1
 118 004e FFF7FEFF 		bl	SysTick_CounterCmd
 119              	.LVL2:
  55:hal/system/Systick.c **** 	NVIC_SystemHandlerPriorityConfig(SystemHandler_SysTick, 3, 0);
 120              		.loc 1 55 2 view .LVU29
 121 0052 0548     		ldr	r0, .L12
 122 0054 0022     		movs	r2, #0
 123 0056 0321     		movs	r1, #3
 124 0058 FFF7FEFF 		bl	NVIC_SystemHandlerPriorityConfig
 125              	.LVL3:
  56:hal/system/Systick.c **** 	/* Enable SysTick interrupt */
  57:hal/system/Systick.c **** 	SysTick_ITConfig(ENABLE);
 126              		.loc 1 57 2 view .LVU30
  58:hal/system/Systick.c **** }
 127              		.loc 1 58 1 is_stmt 0 view .LVU31
 128 005c BDE80840 		pop	{r3, lr}
 129              	.LCFI1:
 130              		.cfi_restore 14
 131              		.cfi_restore 3
 132              		.cfi_def_cfa_offset 0
  57:hal/system/Systick.c **** }
 133              		.loc 1 57 2 view .LVU32
 134 0060 0120     		movs	r0, #1
 135 0062 FFF7FEBF 		b	SysTick_ITConfig
 136              	.LVL4:
 137              	.L13:
 138 0066 00BF     		.align	2
 139              	.L12:
 140 0068 9AC30200 		.word	181146
 141              		.cfi_endproc
 142              	.LFE1:
 144              		.align	1
 145              		.p2align 2,,3
 146              		.global	systick_getTimer
 147              		.syntax unified
 148              		.thumb
 149              		.thumb_func
 151              	systick_getTimer:
 152              	.LFB2:
  59:hal/system/Systick.c **** 
  60:hal/system/Systick.c **** /* get system timer in [ms] */
  61:hal/system/Systick.c **** uint32_t systick_getTimer()
  62:hal/system/Systick.c **** {
 153              		.loc 1 62 1 is_stmt 1 view -0
 154              		.cfi_startproc
 155              		@ args = 0, pretend = 0, frame = 0
 156              		@ frame_needed = 0, uses_anonymous_args = 0
 157              		@ link register save eliminated.
  63:hal/system/Systick.c **** 	return sysTickTimer;
 158              		.loc 1 63 2 view .LVU34
 159              		.loc 1 63 9 is_stmt 0 view .LVU35
 160 006c 014B     		ldr	r3, .L15
 161 006e 5868     		ldr	r0, [r3, #4]
  64:hal/system/Systick.c **** }
 162              		.loc 1 64 1 view .LVU36
 163 0070 7047     		bx	lr
 164              	.L16:
 165 0072 00BF     		.align	2
 166              	.L15:
 167 0074 00000000 		.word	.LANCHOR0
 168              		.cfi_endproc
 169              	.LFE2:
 171              		.align	1
 172              		.p2align 2,,3
 173              		.global	wait
 174              		.syntax unified
 175              		.thumb
 176              		.thumb_func
 178              	wait:
 179              	.LVL5:
 180              	.LFB3:
  65:hal/system/Systick.c **** 
  66:hal/system/Systick.c **** void wait(uint16_t time)
  67:hal/system/Systick.c **** {
 181              		.loc 1 67 1 is_stmt 1 view -0
 182              		.cfi_startproc
 183              		@ args = 0, pretend = 0, frame = 0
 184              		@ frame_needed = 0, uses_anonymous_args = 0
 185              		@ link register save eliminated.
  68:hal/system/Systick.c **** 	uint32_t startTime = systick_getTimer();
 186              		.loc 1 68 2 view .LVU38
 187              	.LBB6:
 188              	.LBI6:
  61:hal/system/Systick.c **** {
 189              		.loc 1 61 10 view .LVU39
 190              	.LBB7:
  63:hal/system/Systick.c **** }
 191              		.loc 1 63 2 view .LVU40
  63:hal/system/Systick.c **** }
 192              		.loc 1 63 9 is_stmt 0 view .LVU41
 193 0078 034A     		ldr	r2, .L20
 194 007a 5168     		ldr	r1, [r2, #4]
 195              	.LVL6:
  63:hal/system/Systick.c **** }
 196              		.loc 1 63 9 view .LVU42
 197              	.LBE7:
 198              	.LBE6:
  69:hal/system/Systick.c **** 	while ((systick_getTimer()-startTime) < time){;}
 199              		.loc 1 69 2 is_stmt 1 view .LVU43
 200              	.L18:
 201              		.loc 1 69 48 discriminator 1 view .LVU44
 202              		.loc 1 69 8 discriminator 1 view .LVU45
 203              	.LBB8:
 204              	.LBI8:
  61:hal/system/Systick.c **** {
 205              		.loc 1 61 10 discriminator 1 view .LVU46
 206              	.LBB9:
  63:hal/system/Systick.c **** }
 207              		.loc 1 63 2 discriminator 1 view .LVU47
  63:hal/system/Systick.c **** }
 208              		.loc 1 63 9 is_stmt 0 discriminator 1 view .LVU48
 209 007c 5368     		ldr	r3, [r2, #4]
 210              	.LBE9:
 211              	.LBE8:
 212              		.loc 1 69 28 discriminator 1 view .LVU49
 213 007e 5B1A     		subs	r3, r3, r1
 214              		.loc 1 69 8 discriminator 1 view .LVU50
 215 0080 8342     		cmp	r3, r0
 216 0082 FBD3     		bcc	.L18
  70:hal/system/Systick.c **** }
 217              		.loc 1 70 1 view .LVU51
 218 0084 7047     		bx	lr
 219              	.L21:
 220 0086 00BF     		.align	2
 221              	.L20:
 222 0088 00000000 		.word	.LANCHOR0
 223              		.cfi_endproc
 224              	.LFE3:
 226              		.bss
 227              		.align	2
 228              		.set	.LANCHOR0,. + 0
 231              	sysTickDivFlag:
 232 0000 00       		.space	1
 233 0001 000000   		.space	3
 236              	sysTickTimer:
 237 0004 00000000 		.space	4
 238              		.text
 239              	.Letext0:
 240              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 241              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 242              		.file 4 "./cpu/STM32F103/stm32f10x_systick.h"
 243              		.file 5 "./cpu/STM32F103/stm32f10x_nvic.h"
 244              		.file 6 "hal/system/../../TMC-API/tmc/helpers/Types.h"
 245              		.file 7 "./cpu/STM32F103/stm32f10x_type.h"
DEFINED SYMBOLS
                            *ABS*:00000000 Systick.c
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:17     .text:00000000 $t
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:24     .text:00000000 SysTickHandler
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:82     .text:00000030 $d
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:88     .text:0000003c $t
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:95     .text:0000003c systick_init
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:140    .text:00000068 $d
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:144    .text:0000006c $t
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:151    .text:0000006c systick_getTimer
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:167    .text:00000074 $d
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:171    .text:00000078 $t
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:178    .text:00000078 wait
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:222    .text:00000088 $d
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:227    .bss:00000000 $d
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:231    .bss:00000000 sysTickDivFlag
C:\Users\forre\AppData\Local\Temp\cc1tDSty.s:236    .bss:00000004 sysTickTimer

UNDEFINED SYMBOLS
UARTTimeoutTimer
UARTTimeoutFlag
SysTick_CLKSourceConfig
SysTick_SetReload
SysTick_CounterCmd
NVIC_SystemHandlerPriorityConfig
SysTick_ITConfig
